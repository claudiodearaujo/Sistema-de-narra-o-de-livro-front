<div class="p-fluid">
    <form [formGroup]="form" (ngSubmit)="import()">
        <div class="field mb-4">
            <label for="defaultCharacterId"
                class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">Personagem Padrão</label>
            <p-select id="defaultCharacterId" [options]="characters" formControlName="defaultCharacterId"
                optionLabel="name" optionValue="id" placeholder="Selecione um personagem" [filter]="true"
                filterBy="name" [showClear]="true" appendTo="body">
                <ng-template pTemplate="selectedItem" let-selectedOption>
                    <div class="flex align-items-center gap-2" *ngIf="selectedOption">
                        <div
                            class="w-6 h-6 rounded-full bg-indigo-100 dark:bg-indigo-900 flex items-center justify-center text-indigo-600 dark:text-indigo-300 font-bold text-xs">
                            {{ selectedOption.name.charAt(0).toUpperCase() }}
                        </div>
                        <div>{{ selectedOption.name }}</div>
                    </div>
                </ng-template>
                <ng-template pTemplate="item" let-character>
                    <div class="flex align-items-center gap-2">
                        <div
                            class="w-6 h-6 rounded-full bg-indigo-100 dark:bg-indigo-900 flex items-center justify-center text-indigo-600 dark:text-indigo-300 font-bold text-xs">
                            {{ character.name.charAt(0).toUpperCase() }}
                        </div>
                        <div>{{ character.name }}</div>
                    </div>
                </ng-template>
            </p-select>
            <small *ngIf="form.get('defaultCharacterId')?.invalid && form.get('defaultCharacterId')?.touched"
                class="p-error block mt-1">
                Personagem padrão é obrigatório.
            </small>
        </div>

        <div class="field mb-4">
            <label class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2">Estratégia de Divisão</label>
            <div class="flex flex-col gap-2">
                <div class="flex align-items-center">
                    <p-radioButton name="strategy" value="paragraph" formControlName="strategy"
                        inputId="strategy1"></p-radioButton>
                    <label for="strategy1" class="ml-2">Por Parágrafo (Quebra de linha dupla)</label>
                </div>
                <div class="flex align-items-center">
                    <p-radioButton name="strategy" value="sentence" formControlName="strategy"
                        inputId="strategy2"></p-radioButton>
                    <label for="strategy2" class="ml-2">Por Frase (Ponto final, exclamação, interrogação)</label>
                </div>
                <div class="flex align-items-center">
                    <p-radioButton name="strategy" value="dialog" formControlName="strategy"
                        inputId="strategy3"></p-radioButton>
                    <label for="strategy3" class="ml-2">Por Diálogo (Quebra de linha simples)</label>
                </div>
            </div>
        </div>

        <div class="field mb-6">
            <label for="text" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">Texto
                Completo</label>
            <textarea id="text" pTextarea formControlName="text" rows="10"
                placeholder="Cole o texto do capítulo aqui..." class="w-full">
            </textarea>
            <small *ngIf="form.get('text')?.invalid && form.get('text')?.touched" class="p-error block mt-1">
                Texto é obrigatório.
            </small>
        </div>

        <div class="flex justify-end gap-2">
            <button pButton type="button" label="Cancelar" class="p-button-text" (click)="cancel()"></button>
            <button pButton type="submit" label="Importar" [disabled]="form.invalid || loading"
                [loading]="loading"></button>
        </div>
    </form>
</div>