<div class="conversation-container">
  <!-- Header -->
  <div class="conversation-header">
    <button pButton class="p-button-text p-button-rounded" icon="pi pi-arrow-left" (click)="goBack()"></button>
    
    @if (otherUser()) {
      <div class="user-info" (click)="goToProfile()">
        <p-avatar [label]="otherUser()?.initials" shape="circle"></p-avatar>
        <div class="user-details">
          <span class="user-name">{{ otherUser()?.name }}</span>
          <span class="user-status" [class.online]="otherUser()?.isOnline">
            {{ otherUser()?.isOnline ? 'Online' : 'Offline' }}
          </span>
        </div>
      </div>
    }
    
    <button pButton class="p-button-text p-button-rounded" icon="pi pi-ellipsis-v"></button>
  </div>

  <!-- Messages -->
  <div class="messages-container" #messagesContainer>
    @if (loading()) {
      <div class="loading">
        <i class="pi pi-spin pi-spinner"></i>
        Carregando mensagens...
      </div>
    } @else {
      <div class="messages-list">
        @for (message of messages(); track message.id) {
          <div class="message" [class.mine]="message.isMe" [class.theirs]="!message.isMe">
            <div class="message-bubble">
              <p>{{ message.content }}</p>
              <span class="message-time">{{ message.time }}</span>
            </div>
          </div>
        }
      </div>
    }
  </div>

  <!-- Input -->
  <div class="message-input">
    <button pButton class="p-button-text p-button-rounded" icon="pi pi-image"></button>
    <input 
      type="text" 
      pInputText 
      [(ngModel)]="newMessage" 
      placeholder="Digite uma mensagem..."
      (keyup.enter)="sendMessage()">
    <button 
      pButton 
      class="p-button-rounded send-btn" 
      icon="pi pi-send"
      [disabled]="!newMessage.trim()"
      (click)="sendMessage()">
    </button>
  </div>
</div>
