<div class="forgot-container">
  <div class="forgot-card">
    @if (!emailSent()) {
      <div class="forgot-header">
        <div class="icon-wrapper">
          <i class="pi pi-lock"></i>
        </div>
        <h1>Esqueceu sua senha?</h1>
        <p>Não se preocupe! Digite seu e-mail e enviaremos instruções para recuperar sua senha.</p>
      </div>

      @if (errorMessage) {
        <p-message severity="error" [text]="errorMessage" styleClass="w-full mb-4" />
      }

      <form [formGroup]="forgotForm" (ngSubmit)="onSubmit()" class="forgot-form">
        <div class="field">
          <label for="email">E-mail</label>
          <input
            pInputText
            id="email"
            type="email"
            formControlName="email"
            placeholder="seu@email.com"
            class="w-full"
          />
          @if (f['email'].invalid && f['email'].touched) {
            <small class="p-error">
              @if (f['email'].errors?.['required']) {
                E-mail é obrigatório
              } @else if (f['email'].errors?.['email']) {
                E-mail inválido
              }
            </small>
          }
        </div>

        <p-button
          type="submit"
          label="Enviar instruções"
          styleClass="w-full"
          [loading]="isSubmitting()"
          [disabled]="forgotForm.invalid || isSubmitting()"
        />
      </form>
    } @else {
      <div class="success-state">
        <div class="icon-wrapper success">
          <i class="pi pi-check"></i>
        </div>
        <h1>E-mail enviado!</h1>
        <p>{{ successMessage }}</p>
        <p class="hint">Verifique sua caixa de entrada e spam.</p>
        
        <p-button
          label="Enviar novamente"
          [outlined]="true"
          styleClass="w-full mt-4"
          (onClick)="resendEmail()"
        />
      </div>
    }

    <div class="forgot-footer">
      <a routerLink="/auth/login">
        <i class="pi pi-arrow-left"></i>
        Voltar ao login
      </a>
    </div>
  </div>
</div>
